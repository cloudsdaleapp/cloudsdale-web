.page-header
  .row
    .span3
      - if @user.avatar.url
        = image_tag @user.avatar, :title => @user.character.name, :class => 'avatar'
      - else
        = image_tag "other/unknown_pony.jpg", :title => @user.character.name, :class => 'avatar'
    .span2
      %h5.gender= @user.character.gender.capitalize if @user.character.gender
      %h5.kind= @user.character.kind.capitalize if @user.character.kind
      %h5.subscribers= "#{@user.subscriber_ids.count} subscribers"
    .span11
      %h1
        = @user.character.name
      %h4
        - if @user.is_online?
          %span{ :class => "online"}= "Online"
          = "Last activity #{time_ago_in_words(@user.last_activity)} ago"
        - else
          %span{ :class => "offline"}= "Offline"
          = "Last activity #{time_ago_in_words(@user.last_activity)} ago"
      %ul.tabs
        %li{ :class => "#{ params[:tab].nil? ? 'active' : '' }" }
          = link_to "Profile", edit_user_path(current_user)
        %li{ :class => "#{ params[:tab] == 'account' ? 'active' : '' }" }
          = link_to "Account", edit_user_path(current_user, tab: 'account')
        %li{ :class => "#{ params[:tab] == 'security' ? 'active' : '' }" }
          = link_to "Security", edit_user_path(current_user, tab: 'security')
        %li{ :class => "#{ params[:tab] == 'chat' ? 'active' : '' }" }
          = link_to "Chat", edit_user_path(current_user, tab: 'chat')
          
.row
  .span4.left
  .span12.right
    = form_for @user, :multipart => true, :validate => true, :url => user_path(@user), :method => :put, :html => { :class => 'with_notifications' } do |f|
      .row
        - if params[:tab].nil?
          = render :partial => 'edit_profile_tab', :locals => { f: f }
        - elsif params[:tab] == 'account'
          = render :partial => 'edit_account_tab', :locals => { f: f }
        - elsif params[:tab] == 'security'
          = render :partial => 'edit_security_tab', :locals => { f: f }
        - elsif params[:tab] == 'chat'
          = render :partial => 'edit_chat_tab', :locals => { f: f }

      
      %fieldset
        .actions
          = f.submit "Save", :class => 'btn primary'
