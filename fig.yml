app:
  build: .
  command: "bundle exec rails s -e development -p 8080"
  ports:
   - "0.0.0.0:8080:8080"
  links:
    - mongo
    - redis
    - rabbit
    - mail
  volumes:
    - .:/usr/src/www.cloudsdale.org
  volumes_from:
    - gems
  environment:
    RAILS_ENV: development

gems:
  image: busybox:latest
  command: "tail -f /dev/null"
  volumes:
    - /usr/local/bundle

mongo:
  image: mongo:2.4.10
  command: mongod --smallfiles --verbose
  volumes:
    - ./db/data:/data
  ports:
    - "27017:27017"

redis:
  image: redis:latest
  command: redis-server
  ports:
    - "6379:6379"

rabbit:
  image: tutum/rabbitmq:latest
  ports:
    - "5672:5672"
    - "15672:15672"
  volumes:
    - /var/log/rabbitmq
  environment:
    - RABBITMQ_PASS=pass

memcached:
  image: tutum/memcached:latest
  ports:
    - "11211:11211"

mail:
  image: schickling/mailcatcher:latest
  ports:
    - "1025:1025"
    - "1080:1080"